
// swtch(struct context* old,struct context* new)
// 保存 old,加载 new ; old->a0,new->a1

.global swtch
swtch:
    sw ra,0(a0)
    sw sp,4(a0)
    sw gp,8(a0)
    // The tp register is not saved 
    // because the HART of the last execution may be
    // different from the HART of this execution,
    // and the save load may wait for the wrong HART ID (lock use) 
    # sw tp,12(a0)
    sw a0,16(a0)
    sw a1,20(a0)
    sw a2,24(a0)
    sw a3,28(a0)
    sw a4,32(a0)
    sw a5,36(a0)
    sw a6,40(a0)
    sw a7,44(a0)
    sw s0,48(a0)
    sw s1,52(a0)
    sw s2,56(a0)
    sw s3,60(a0)
    sw s4,64(a0)
    sw s5,68(a0)
    sw s6,72(a0)
    sw s7,76(a0)
    sw s8,80(a0)
    sw s9,84(a0)
    sw s10,88(a0)
    sw s11,92(a0)
    sw t0,96(a0)
    sw t1,100(a0)
    sw t2,104(a0)
    sw t3,108(a0)
    sw t4,112(a0)
    sw t5,116(a0)
    sw t6,120(a0)


    lw ra,0(a1)
    lw sp,4(a1)
    lw gp,8(a1)
    # lw tp,12(a1)
    lw a0,16(a1)
    // a1
    lw a2,24(a1)
    lw a3,28(a1)
    lw a4,32(a1)
    lw a5,36(a1)
    lw a6,40(a1)
    lw a7,44(a1)
    lw s0,48(a1)
    lw s1,52(a1)
    lw s2,56(a1)
    lw s3,60(a1)
    lw s4,64(a1)
    lw s5,68(a1)
    lw s6,72(a1)
    lw s7,76(a1)
    lw s8,80(a1)
    lw s9,84(a1)
    lw s10,88(a1)
    lw s11,92(a1)
    lw t0,96(a1)
    lw t1,100(a1)
    lw t2,104(a1)
    lw t3,108(a1)
    lw t4,112(a1)
    lw t5,116(a1)
    lw t6,120(a1)

    lw a1,20(a1)

    ret